<?xml version="1.0" encoding="utf-8" ?>
<log4net>
  <root>
    <appender-ref ref="error-file" />
    <appender-ref ref="debug-file" />
    <appender-ref ref="ado-net" />
    <appender-ref ref="ConsoleAppender" />
  </root>
  <logger name="mspend.logger">
    <priority value="ERROR" />
    <appender-ref ref="ConsoleAppender" />
    <appender-ref ref="error-file" />
  </logger>
  <logger name="wlyc.admin">
    <priority value="INFO" />
    <appender-ref ref="ConsoleAppender-Admin" />
    <appender-ref ref="ado-net-admin-log" />
  </logger>
  <appender name="ConsoleAppender" type="log4net.Appender.ConsoleAppender" >
    <layout type="log4net.Layout.PatternLayout">
      <conversionPattern value="%date [%thread] %-5level %logger [%ndc] - %message%newline" />
    </layout>
  </appender>
  <appender name="debug-file" type="log4net.Appender.RollingFileAppender">
    <file value="d:/wlyc-debug/" />
    <appendToFile value="true" />
    <!-- Immediate flush on error log, to avoid data loss with sudden termination. -->
    <immediateFlush value="true" />
    <staticLogFileName value="false" />
    <rollingStyle value="Date" />
    <datepattern value="yyyy.MM.dd'.log'" />
    <!-- Prevents Orchard.exe from displaying locking debug messages. -->
    <lockingModel type="log4net.Appender.FileAppender+MinimalLock" />
    <layout type="log4net.Layout.PatternLayout">
      <conversionPattern value="%date [%thread] %logger - %P{Tenant} - %level% %message%newline" />
    </layout>
  </appender>
  <appender name="error-file" type="log4net.Appender.RollingFileAppender">
    <file value="d:/wlyc-error/" />
    <appendToFile value="true" />
    <!-- Immediate flush on error log, to avoid data loss with sudden termination. -->
    <immediateFlush value="true" />
    <staticLogFileName value="false" />
    <rollingStyle value="Date" />
    <datepattern value="yyyy.MM.dd'.log'" />
    <!-- Prevents Orchard.exe from displaying locking debug messages. -->
    <lockingModel type="log4net.Appender.FileAppender+MinimalLock" />
    <filter type="log4net.Filter.LevelRangeFilter">
      <!-- Only ERROR and FATAL log messages end up in this target, even if child loggers accept lower priority. -->
      <levelMin value="ERROR" />
    </filter>
    <layout type="log4net.Layout.PatternLayout">
      <conversionPattern value="%date [%thread] %logger - %P{Tenant} - %message [%P{Url}]%newline" />
    </layout>
  </appender>
  <appender name="ado-net" type="log4net.Appender.ADONetAppender">
    <bufferSize value="1" />
    <connectionType value="MySql.Data.MySqlClient.MySqlConnection, MySql.Data" />
    <connectionString value="server=.;Database=wlyc;Uid=root;Pwd=123456;Allow User Variables=True;" />
    <commandText value="insert into logerror(time,thread,log_level,exception,message,logger) values (@log_date,@thread,@log_level,@exception,@message,@logger);" />
    <parameter>
      <parameterName value="@log_date" />
      <dbType value="String" />
      <size value="255" />
      <layout type="log4net.Layout.PatternLayout">
        <conversionPattern value="%date" />
      </layout>
    </parameter>
    <parameter>
      <parameterName value="@thread" />
      <dbType value="String" />
      <size value="255" />
      <layout type="log4net.Layout.PatternLayout">
        <conversionPattern value="%thread" />
      </layout>
    </parameter>
    <parameter>
      <parameterName value="@log_level" />
      <dbType value="String" />
      <size value="50" />
      <layout type="log4net.Layout.PatternLayout">
        <conversionPattern value="%level" />
      </layout>
    </parameter>
    <parameter>
      <parameterName value="@exception" />
      <dbType value="String" />
      <size value="2048" />
      <layout type="log4net.Layout.PatternLayout">
        <conversionPattern value="%newline%exception" />
      </layout>
    </parameter>
    <parameter>
      <parameterName value="@message" />
      <dbType value="String" />
      <size value="1024" />
      <layout type="log4net.Layout.PatternLayout">
        <conversionPattern value="%message" />
      </layout>
    </parameter>
    <parameter>
      <parameterName value="@logger" />
      <dbType value="String" />
      <size value="50" />
      <layout type="log4net.Layout.PatternLayout">
        <conversionPattern value="%logger" />
      </layout>
    </parameter>
  </appender>
  <appender name="ado-net-admin-log" type="log4net.Appender.ADONetAppender">
    <bufferSize value="1" />
    <connectionType value="MySql.Data.MySqlClient.MySqlConnection, MySql.Data" />
    <connectionString value="server=.;Database=wlyc;user id=root;password=123456;" providerName="MySql.Data.MySqlClient;"/>
    <commandText value="INSERT INTO logadmin(user_id,user_name,target,remark,detail,ip,create_time) VALUES (@user_id,@user_name,@target,@remark,@detail,@ip,@create_time)" />
    <parameter>
      <parameterName value="@user_id" />
      <dbType value="String" />
      <size value="50" />
      <layout type="WLYC.Framework.Logging.Admin.AdminLayoutPattern">
        <conversionPattern value="%AdminLog{UserId}" />
      </layout>
    </parameter>
    <parameter>
      <parameterName value="@user_name" />
      <dbType value="String" />
      <size value="50" />
      <layout type="WLYC.Framework.Logging.Admin.AdminLayoutPattern">
        <conversionPattern value="%AdminLog{UserName}" />
      </layout>
    </parameter>
    <parameter>
      <parameterName value="@target" />
      <dbType value="String" />
      <size value="50" />
      <layout type="WLYC.Framework.Logging.Admin.AdminLayoutPattern">
        <conversionPattern value="%AdminLog{Target}" />
      </layout>
    </parameter>
    <parameter>
      <parameterName value="@remark" />
      <dbType value="String" />
      <size value="200" />
      <layout type="WLYC.Framework.Logging.Admin.AdminLayoutPattern">
        <conversionPattern value="%AdminLog{Remark}" />
      </layout>
    </parameter>
    <parameter>
      <parameterName value="@detail" />
      <dbType value="String" />
      <size value="1024" />
      <layout type="WLYC.Framework.Logging.Admin.AdminLayoutPattern">
        <conversionPattern value="%AdminLog{Detail}" />
      </layout>
    </parameter>
    <parameter>
      <parameterName value="@ip" />
      <dbType value="String" />
      <size value="50" />
      <layout type="WLYC.Framework.Logging.Admin.AdminLayoutPattern">
        <conversionPattern value="%AdminLog{Ip}" />
      </layout>
    </parameter>
    <parameter>
      <parameterName value="@create_time" />
      <dbType value="DateTime" />
      <layout type="log4net.Layout.PatternLayout">
        <conversionPattern value="%date" />
      </layout>
    </parameter>
  </appender>
  <appender name="ConsoleAppender-Admin" type="log4net.Appender.ConsoleAppender" >
    <layout type="WLYC.Framework.Logging.Admin.AdminLayoutPattern">
      <conversionPattern value="%AdminLog{UserId} %AdminLog{UserName} %AdminLog{ObjName} %AdminLog{Remark} %AdminLog{Detail} %AdminLog{Ip} %date" />
    </layout>
  </appender>
</log4net>